#!/usr/bin/env bash
# This script modifies the /etc/hosts file to change the resolution of localhost and facebook.com

# Ensure the script is run as root (required to edit /etc/hosts)
if [ "$(id -u)" -ne 0 ]; then
    echo "Please run this script as root."
    exit 1
fi

# Backup the current /etc/hosts file before making changes
cp /etc/hosts /etc/hosts.bak

# Modify localhost to resolve to 127.0.0.2 instead of 127.0.0.1
sed -i 's/^127\.0\.0\.1 localhost$/127.0.0.2 localhost/' /etc/hosts

# Ensure facebook.com resolves to 8.8.8.8 (prevent duplicate entries)
grep -q "8.8.8.8 facebook.com" /etc/hosts || echo "8.8.8.8 facebook.com" >> /etc/hosts

# Restart the DNS resolver service to apply the changes
systemctl restart systemd-resolved

# Display confirmation message
echo "Hosts file updated successfully!"
echo "Verify changes with: cat /etc/hosts"
echo "Test resolution with: ping localhost and ping facebook.com"
